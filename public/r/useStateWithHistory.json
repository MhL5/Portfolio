{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "useStateWithHistory",
  "type": "registry:hook",
  "title": "useStateWithHistory",
  "description": "A hook that extends useState with history functionality, allowing undo and redo operations.",
  "files": [
    {
      "path": "src/registry/hooks/useStateWithHistory/useStateWithHistory.ts",
      "content": "\"use client\";\n\nimport { useCallback, useRef, useState } from \"react\";\n\nexport function useStateWithHistory<T>(\n  defaultValue: T,\n  { capacity = 10 }: { capacity?: number } = {},\n) {\n  const [value, setValue] = useState(defaultValue);\n  const historyRef = useRef([value]);\n  const pointerRef = useRef(0);\n\n  const set = useCallback(\n    (v: T | ((v: T) => T)) => {\n      const resolvedValue =\n        typeof v === \"function\" ? (v as (v: T) => T)(value) : v;\n\n      if (historyRef.current[pointerRef.current] !== resolvedValue) {\n        if (pointerRef.current < historyRef.current.length - 1)\n          historyRef.current.splice(pointerRef.current + 1);\n\n        historyRef.current.push(resolvedValue);\n\n        while (historyRef.current.length > capacity) {\n          historyRef.current.shift();\n        }\n        pointerRef.current = historyRef.current.length - 1;\n      }\n\n      setValue(resolvedValue);\n    },\n    [capacity, value],\n  );\n\n  const back = useCallback(() => {\n    if (pointerRef.current <= 0) return;\n    pointerRef.current--;\n    setValue(historyRef.current[pointerRef.current]);\n  }, []);\n\n  const forward = useCallback(() => {\n    if (pointerRef.current >= historyRef.current.length - 1) return;\n    pointerRef.current++;\n    setValue(historyRef.current[pointerRef.current]);\n  }, []);\n\n  const go = useCallback((index: number) => {\n    if (index < 0 || index > historyRef.current.length - 1) return;\n    pointerRef.current = index;\n    setValue(historyRef.current[pointerRef.current]);\n  }, []);\n\n  return [\n    value,\n    set,\n    {\n      history: historyRef.current,\n      pointer: pointerRef.current,\n      back,\n      forward,\n      go,\n    },\n  ] as const;\n}\n",
      "type": "registry:hook"
    }
  ]
}